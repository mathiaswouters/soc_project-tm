# Security Operations Center

In this project, I developed a comprehensive **Security Operations Center (SOC)** as part of my coursework in Cybersecurity. The SOC was designed to detect, analyze, and respond to a wide range of security incidents, providing a proactive defense for an internal network. The project combined several open-source tools to build an integrated system capable of real-time monitoring and automated incident response, simulating real-world security operations scenarios.

**Report:** [SOC Documentation](soc_documentatie.pdf)

**Video:** [YouTube](https://youtu.be/N6xHx_H27Vk)

**Completed:** December 2023

## Security Operations Center

### Overview of the SOC Architecture
The SOC was deployed in a virtual environment using **Ubuntu Server 22.04** as the core operating system. I chose Ubuntu due to its flexibility, security, and familiarity with Linux-based security tools. The production system was secured by **pfSense**, a powerful firewall and router solution, which managed all network traffic. pfSense ensured that the internal network was shielded from external threats by segmenting traffic and acting as the first line of defense.

### Threat Detection and Prevention
To detect network-level threats, I deployed **Suricata**, an open-source **Intrusion Detection and Prevention System (IDS/IPS)**. Suricata was strategically placed on the pfSense firewall, allowing it to inspect all incoming and outgoing network traffic. By analyzing packet data and comparing it to known attack signatures, Suricata was able to detect malicious activities, such as brute-force attempts, port scans, or exploit attempts. When a potential threat was detected, Suricata generated alerts and forwarded them to the centralized monitoring system for further analysis.

### Centralized Log Management and SIEM: Wazuh
A key component of the SOC was the **Wazuh** platform, which acted as the **Security Information and Event Management (SIEM)** solution. Wazuh collected and aggregated logs from multiple endpoints, including the Ubuntu server and pfSense firewall. This centralized approach allowed me to track and correlate security events across the entire network. Wazuh's powerful alerting mechanism monitored for a variety of threats, such as:
- **Known vulnerabilities**: Wazuh periodically scanned systems for known vulnerabilities (CVE) and alerted me if unpatched software was detected, allowing for timely remediation.
- **Brute-force attacks**: SSH connections to the Ubuntu server were monitored, and repeated failed login attempts triggered alerts, indicating brute-force attacks.
- **File tampering**: The integrity of critical files was maintained through **File Integrity Monitoring (FIM)**. Any unauthorized modifications to important files were detected, and alerts were generated in real-time.
- **Rootkit detection**: Wazuh was configured to scan for rootkits, a type of malware that attempts to hide its presence within the system. These scans were done periodically to ensure system integrity.

### Malware Detection and Automated Response with VirusTotal
To enhance the SOC’s capability for malware detection, I integrated **VirusTotal** into Wazuh. VirusTotal is an online service that scans files for potential malware by comparing them against a database of known threats. In my project, when a new file appeared on the system, Wazuh triggered an automatic scan using VirusTotal’s API. If the file was flagged as malicious, a shell script was executed to automatically delete the file, providing an immediate response to the threat.

This integration allowed for seamless identification and removal of malware, significantly reducing the time between detection and remediation.

### Automation and Incident Response: Shuffle IO
In addition to detection, automation was a critical aspect of the SOC. I implemented **Shuffle IO**, a **Security Orchestration, Automation, and Response (SOAR)** solution. Shuffle IO helped automate many of the manual tasks that are traditionally required in security operations, streamlining the workflow and reducing response time.

The automation process worked as follows:
- Security alerts generated by Wazuh were automatically forwarded to Shuffle IO.
- Depending on the severity of the alert, a predefined workflow was triggered. For instance, critical alerts resulted in automated notifications being sent to my dedicated Discord channel for real-time updates.
- **TheHive**, an incident response platform, was also integrated with Shuffle IO. When an alert included critical details such as an attacker’s IP address, this information was automatically passed to TheHive for further investigation and tracking.

This approach ensured that important security events were never missed and allowed me to react quickly to potential threats.

### Incident Management and Collaboration: TheHive
To manage security incidents efficiently, I integrated **TheHive**, an open-source platform specifically designed for handling incident response. TheHive allowed me to organize, classify, and track security incidents based on their severity and type. It provided a centralized view of all ongoing and resolved incidents, ensuring that nothing slipped through the cracks.

Key features of TheHive included:
- **Collaboration tools**: I was able to add notes, assign tasks, and share information within TheHive, making it easy to manage incidents collaboratively in a team setting.
- **Tracking and reporting**: Each security incident was tracked from detection to resolution, ensuring a structured response process. After resolving incidents, the data collected was used to generate reports that provided insights for improving security posture and addressing weaknesses.

### Project Outcomes and Key Learnings
Through the development of this SOC, I gained significant hands-on experience with several critical cybersecurity tools and concepts. The project allowed me to explore:
- **Threat detection and prevention** techniques using Suricata and Wazuh.
- **Automated incident response** through the use of SOAR tools like Shuffle IO.
- **Incident management** and collaboration using TheHive.
- The importance of **proactive defense** and **continuous monitoring** in maintaining a secure network environment.

This SOC was not only capable of detecting a wide variety of cyber threats but also implemented automated responses and incident management workflows, resulting in a fast, efficient, and well-coordinated defense system. This project solidified my understanding of SOC operations and prepared me to face real-world cybersecurity challenges in a dynamic environment.

![SOC Scheme](img/SOC-3.png)
